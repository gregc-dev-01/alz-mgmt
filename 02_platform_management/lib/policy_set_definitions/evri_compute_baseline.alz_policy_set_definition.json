{
  "name": "PI-Evri-Compute-Baseline",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2024-04-01",
  "properties": {
    "displayName": "EVRi Compute Baseline",
    "description": "MC: Policy Initiative for baseline compute scoped at the Evri Management Group layer. Includes VM boot diagnostics and allowed extensions.",
    "metadata": {
      "version": "1.0.0",
      "category": "Compute"
    },
    "policyType": "Custom",
    "parameters": {
      "approvedExtensions": {
        "type": "Array",
        "metadata": {
          "displayName": "List of Allowed VM Extensions",
          "description": "The list of approved extension types that can be installed. Example: AzureDiskEncryption"
        },
        "defaultValue": []
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "PD-Compute-BootDiagnostics-001",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fb97d6e1-5c98-4743-a439-23e0977bad9e",
        "parameters": {},
        "groupNames": ["Resource-Baseline-Compute"]
      },
      {
        "policyDefinitionReferenceId": "PD-Compute-ApprovedExtensions-001",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c0e996f8-39cf-4af9-9f45-83fbde810432",
        "parameters": {
          "approvedExtensions": {
            "value": "[parameters('approvedExtensions')]"
          }
        },
        "groupNames": ["Resource-Baseline-Compute"]
      }
    ],
    "policyDefinitionGroups": [
      {
        "name": "Resource-Baseline-Compute",
        "displayName": "Resource Baseline - Compute",
        "description": "MC: Group for baseline compute configuration to ensure VM diagnostics and allowed extensions."
      }
    ]
  }
}
