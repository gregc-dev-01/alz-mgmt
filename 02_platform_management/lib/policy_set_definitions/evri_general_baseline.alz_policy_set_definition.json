{
  "name": "PI-Evri-General-Baseline",
  "type": "Microsoft.Authorization/policySetDefinitions",
  "apiVersion": "2024-04-01",
  "properties": {
    "policyType": "Custom",
    "displayName": "EVRi General Baseline",
    "description": "MC: Policy Initiative for baseline General scoped at the Evri Management Group layer. Includes Allowed locations (Deny), Allowed VM size SKUs (Deny) and Audit AHUB.",
    "metadata": {
      "version": "1.0.0",
      "category": "General"
    },
    "parameters": {
      "listOfAllowedLocations": {
        "type": "Array",
        "metadata": {
          "displayName": "Allowed locations",
          "description": "Locations that can be specified when deploying resources.",
          "strongType": "location"
        },
        "defaultValue": []
      },
      "listOfAllowedSKUs": {
        "type": "Array",
        "metadata": {
          "displayName": "Allowed VM size SKUs",
          "description": "Virtual machine size SKUs that can be deployed (e.g. Standard_D2s_v5)."
        },
        "defaultValue": []
      }
    },
    "policyDefinitions": [
      {
        "policyDefinitionReferenceId": "AllowedLocations-001",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
        "parameters": {
          "listOfAllowedLocations": {
            "value": "[parameters('listOfAllowedLocations')]"
          }
        },
        "groupNames": ["Resource-Baseline-General"]
      },
      {
        "policyDefinitionReferenceId": "AllowedVmSizes-001",
        "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cccc23c7-8427-4f53-ad12-b6a63eb452b3",
        "parameters": {
          "listOfAllowedSKUs": { "value": "[parameters('listOfAllowedSKUs')]" }
        },
        "groupNames": ["Resource-Baseline-General"]
      },
      {
        "policyDefinitionReferenceId": "Audit-AHUB-001",
        "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/evri/providers/Microsoft.Authorization/policyDefinitions/Audit-AzureHybridBenefit",
        "parameters": {
          "effect": { "value": "Audit" }
        },
        "groupNames": ["Resource-Baseline-General"]
      }
    ],
    "policyDefinitionGroups": [
      {
        "name": "Resource-Baseline-General",
        "displayName": "Resource Baseline - General",
        "description": "MC: Group for General baseline to allow easier management and grouping."
      }
    ]
  }
}
