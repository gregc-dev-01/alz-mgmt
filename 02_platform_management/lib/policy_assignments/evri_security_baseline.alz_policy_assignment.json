{
  "name": "PA-Evri-Sec-Baseline",
  "type": "Microsoft.Authorization/policyAssignments",
  "apiVersion": "2024-04-01",
  "properties": {
    "displayName": "EVRi Security Baseline",
    "description": "MC: Policy Assignment for our Security baseline (PI-Evri-Sec-Baseline) applied at the 'Evri' management group level.",
    "notScopes": [],
    "parameters": {},
    "nonComplianceMessages": [
      {
        "message": "Key Vault must have public network access disabled.",
        "policyDefinitionReferenceId": "KV-DisablePublicNetworkAccess-Deny-001"
      },
      {
        "message": "Key Vault must have soft delete enabled.",
        "policyDefinitionReferenceId": "KV-SoftDelete-Enabled-Deny-001"
      },
      {
        "message": "Key Vault must have purge protection enabled.",
        "policyDefinitionReferenceId": "KV-PurgeProtection-Enabled-Deny-001"
      },
      {
        "message": "Key Vault should use the RBAC permission model.",
        "policyDefinitionReferenceId": "KV-UseRBAC-PermissionModel-Audit-001"
      },
      {
        "message": "Key Vault should have diagnostic logs enabled.",
        "policyDefinitionReferenceId": "KV-DiagnosticLogs-AuditIfNotExists-001"
      },
      {
        "message": "Keys should have a rotation policy scheduled within the required number of days.",
        "policyDefinitionReferenceId": "KV-KeyRotation-Audit-001"
      }
    ],
    "policyDefinitionId": "/providers/Microsoft.Authorization/policySetDefinitions/PI-Evri-Sec-Baseline",
    "scope": "${current_scope_resource_id}"
  },
  "location": "${default_location}",
  "identity": { "type": "SystemAssigned" }
}
